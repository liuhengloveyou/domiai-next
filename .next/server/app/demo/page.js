(()=>{var e={};e.id=436,e.ids=[436],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3855:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,dynamic:()=>i});var a=r(40356);let i=(0,a.registerClientReference)(function(){throw Error("Attempted to call dynamic() from the server but dynamic is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\domiai\\domiai-next\\app\\demo\\page.tsx","dynamic"),n=(0,a.registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\domiai\\\\domiai-next\\\\app\\\\demo\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\domiai\\domiai-next\\app\\demo\\page.tsx","default")},4273:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(57605).A)("download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20696:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d});var a=r(97448),i=r(81303),n=r(23375),s=r.n(n),l=r(37440),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d={children:["",{children:["demo",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3855)),"D:\\domiai\\domiai-next\\app\\demo\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,89032)),"D:\\domiai\\domiai-next\\app\\demo\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,90996))).default(e),async e=>(await Promise.resolve().then(r.bind(r,52511))).default(e),async e=>(await Promise.resolve().then(r.bind(r,74921))).default(e)],apple:[async e=>(await Promise.resolve().then(r.bind(r,45914))).default(e)],openGraph:[],twitter:[],manifest:"/manifest.json"}}]},{layout:[()=>Promise.resolve().then(r.bind(r,49510)),"D:\\domiai\\domiai-next\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,26166)),"D:\\domiai\\domiai-next\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,37056,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,12433,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,90996))).default(e),async e=>(await Promise.resolve().then(r.bind(r,52511))).default(e),async e=>(await Promise.resolve().then(r.bind(r,74921))).default(e)],apple:[async e=>(await Promise.resolve().then(r.bind(r,45914))).default(e)],openGraph:[],twitter:[],manifest:"/manifest.json"}}]}.children,c=["D:\\domiai\\domiai-next\\app\\demo\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/demo/page",pathname:"/demo",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},39532:(e,t,r)=>{Promise.resolve().then(r.bind(r,3855))},45612:(e,t,r)=>{Promise.resolve().then(r.bind(r,75608))},45789:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(60554),i=r(60563),n=r(65317),s=r(83481);function l({className:e,defaultValue:t,value:r,min:l=0,max:o=100,...d}){let c=i.useMemo(()=>Array.isArray(r)?r:Array.isArray(t)?t:[l,o],[r,t,l,o]);return(0,a.jsxs)(n.bL,{"data-slot":"slider",defaultValue:t,value:r,min:l,max:o,className:(0,s.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...d,children:[(0,a.jsx)(n.CC,{"data-slot":"slider-track",className:(0,s.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,a.jsx)(n.Q6,{"data-slot":"slider-range",className:(0,s.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:c.length},(e,t)=>(0,a.jsx)(n.zi,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},t))]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},75608:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N,dynamic:()=>A});var a=r(60554),i=r(60563),n=r(71726),s=r(70400),l=r(45789),o=r(97110),d=r(29203),c=r(68384),u=r(57605);let h=(0,u.A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var m=r(98898);let p=(0,u.A)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),x=(0,u.A)("type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),f=(0,u.A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),g=(0,u.A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),v=(0,u.A)("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),y=(0,u.A)("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);var b=r(4273),w=r(73412),j=r(79169),k=r(83481);let A="force-dynamic";function N(){let{t:e}=(0,j.o)(),[t,r]=(0,i.useState)(!1),u=(0,i.useRef)(null),[A,N]=(0,i.useState)(null),[C,S]=(0,i.useState)("select"),[D,P]=(0,i.useState)(5),[z,I]=(0,i.useState)("#000000"),[M,_]=(0,i.useState)(!1),[q,O]=(0,i.useState)(!1),R=(0,i.useRef)({states:[],currentStateIndex:-1}),$=(0,i.useRef)(null),B=e=>{if(!e)return;let t=R.current,r=JSON.stringify(e.toJSON());t.currentStateIndex<t.states.length-1&&(t.states=t.states.slice(0,t.currentStateIndex+1)),t.states.push(r),t.currentStateIndex=t.states.length-1,_(t.currentStateIndex>0),O(!1)},E=e=>{A&&(S(e),"draw"===e?(A.isDrawingMode=!0,A.freeDrawingBrush&&(A.freeDrawingBrush.width=D),A.freeDrawingBrush&&(A.freeDrawingBrush.color=z)):A.isDrawingMode=!1)};return t?(0,a.jsxs)("div",{className:"min-h-screen",children:[(0,a.jsx)(d.j,{}),(0,a.jsx)("main",{children:(0,a.jsx)(s.Zp,{className:"backdrop-blur-sm bg-background/60 rounded-none border-none h-screen",children:(0,a.jsx)(s.Wu,{className:"pt-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(n.$,{variant:"select"===C?"default":"outline",onClick:()=>E("select"),className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{size:16}),e("select")||"选择"]}),(0,a.jsxs)(n.$,{variant:"draw"===C?"default":"outline",onClick:()=>E("draw"),className:"flex items-center gap-2",children:[(0,a.jsx)(h,{size:16}),e("draw")||"绘制"]}),(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(!A)return;let e=new w.rw({left:100,top:100,fill:z,width:100,height:100,objectCaching:!1});A.add(e),A.setActiveObject(e)},className:"flex items-center gap-2",children:[(0,a.jsx)(m.A,{size:16}),e("rectangle")||"矩形"]}),(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(!A)return;let e=new w.jl({left:100,top:100,fill:z,radius:50,objectCaching:!1});A.add(e),A.setActiveObject(e)},className:"flex items-center gap-2",children:[(0,a.jsx)(p,{size:16}),e("circle")||"圆形"]}),(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(!A)return;let e=new w.DA("双击编辑文本",{left:100,top:100,fontFamily:"sans-serif",fill:z,fontSize:20,objectCaching:!1});A.add(e),A.setActiveObject(e)},className:"flex items-center gap-2",children:[(0,a.jsx)(x,{size:16}),e("text")||"文本"]}),(0,a.jsxs)(n.$,{variant:"outline",className:"flex items-center gap-2 cursor-pointer",onClick:()=>$.current?.click(),children:[(0,a.jsx)(f,{size:16}),e("image")||"图片",(0,a.jsx)("input",{ref:$,type:"file",accept:"image/*",className:"hidden",onChange:e=>{if(!A||!e.target.files||0===e.target.files.length)return;let t=e.target.files[0],r=new FileReader;r.onload=e=>{e.target&&w.Ng.fromURL(e.target.result).then(e=>{let t=.8*A.getWidth(),r=.8*A.getHeight();if(e.width>t||e.height>r){let a=Math.min(t/e.width,r/e.height);e.scale(a)}e.set({left:100,top:100}),A.add(e),A.setActiveObject(e),B(A)})},r.readAsDataURL(t),e.target.value=""}})]}),(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(!A)return;let e=A.getActiveObjects();e.length>0&&(A.remove(...e),A.discardActiveObject(),A.requestRenderAll(),B(A))},className:"flex items-center gap-2 text-red-500 hover:text-red-700",children:[(0,a.jsx)(g,{size:16}),e("delete")||"删除"]}),(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(!A)return;let e=R.current;e.currentStateIndex>0&&(e.currentStateIndex--,A.loadFromJSON(e.states[e.currentStateIndex],A.renderAll.bind(A)),_(e.currentStateIndex>0),O(e.currentStateIndex<e.states.length-1))},disabled:!M,className:(0,k.cn)("flex items-center gap-2",!M&&"opacity-50 cursor-not-allowed"),children:[(0,a.jsx)(v,{size:16}),e("undo")||"撤销"]}),(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(!A)return;let e=R.current;e.currentStateIndex<e.states.length-1&&(e.currentStateIndex++,A.loadFromJSON(e.states[e.currentStateIndex],A.renderAll.bind(A)),_(e.currentStateIndex>0),O(e.currentStateIndex<e.states.length-1))},disabled:!q,className:(0,k.cn)("flex items-center gap-2",!q&&"opacity-50 cursor-not-allowed"),children:[(0,a.jsx)(y,{size:16}),e("redo")||"重做"]}),(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(!A)return;let e=A.toDataURL({format:"png",quality:1,multiplier:1}),t=document.createElement("a");t.download=`fabric-drawing-${new Date().toISOString().slice(0,10)}.png`,t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"flex items-center gap-2 ml-auto",children:[(0,a.jsx)(b.A,{size:16}),e("download")||"下载"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"brush-size",children:e("brushSize")||"画笔大小"}),(0,a.jsx)(l.A,{id:"brush-size",min:1,max:50,step:1,value:[D],onValueChange:e=>{if(!A)return;let t=e[0];P(t),A.isDrawingMode&&A.freeDrawingBrush&&(A.freeDrawingBrush.width=t)},className:"mt-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"brush-color",children:e("brushColor")||"画笔颜色"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{id:"brush-color",type:"color",value:z,onChange:e=>{if(!A)return;let t=e.target.value;I(t),A.isDrawingMode&&A.freeDrawingBrush&&(A.freeDrawingBrush.color=t)},className:"w-10 h-10 rounded cursor-pointer"}),(0,a.jsx)("span",{className:"text-sm",children:z})]})]})]}),(0,a.jsx)("div",{className:"border border-primary/10 rounded-lg overflow-hidden",children:(0,a.jsx)("canvas",{ref:u,className:"w-full max-w-full"})})]})})})})]}):null}},79551:e=>{"use strict";e.exports=require("url")},89032:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i,dynamic:()=>a});let a="force-dynamic";function i({children:e}){return e}},98898:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(57605).A)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[395,145,771,997,317,527,967,830],()=>r(20696));module.exports=a})();