(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{36337:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>B,dynamic:()=>V});var r=s(6658),t=s(39242),n=s(85992),i=s(59994),c=s(56560),l=s(63811),d=s(262),o=s(30405),m=s(33233),u=s(93077),h=s(70999),p=s(77390),x=s(80554),y="Switch",[b,g]=(0,m.A)(y),[j,f]=b(y),v=t.forwardRef((e,a)=>{let{__scopeSwitch:s,name:n,checked:i,defaultChecked:c,required:l,disabled:m,value:h="on",onCheckedChange:p,form:y,...b}=e,[g,f]=t.useState(null),v=(0,o.s)(a,e=>f(e)),k=t.useRef(!1),N=!g||y||!!g.closest("form"),[C=!1,E]=(0,u.i)({prop:i,defaultProp:c,onChange:p});return(0,r.jsxs)(j,{scope:s,checked:C,disabled:m,children:[(0,r.jsx)(x.sG.button,{type:"button",role:"switch","aria-checked":C,"aria-required":l,"data-state":S(C),"data-disabled":m?"":void 0,disabled:m,value:h,...b,ref:v,onClick:(0,d.m)(e.onClick,e=>{E(e=>!e),N&&(k.current=e.isPropagationStopped(),k.current||e.stopPropagation())})}),N&&(0,r.jsx)(w,{control:g,bubbles:!k.current,name:n,value:h,checked:C,required:l,disabled:m,form:y,style:{transform:"translateX(-100%)"}})]})});v.displayName=y;var k="SwitchThumb",N=t.forwardRef((e,a)=>{let{__scopeSwitch:s,...t}=e,n=f(k,s);return(0,r.jsx)(x.sG.span,{"data-state":S(n.checked),"data-disabled":n.disabled?"":void 0,...t,ref:a})});N.displayName=k;var w=e=>{let{control:a,checked:s,bubbles:n=!0,...i}=e,c=t.useRef(null),l=(0,h.Z)(s),d=(0,p.X)(a);return t.useEffect(()=>{let e=c.current,a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(l!==s&&a){let r=new Event("click",{bubbles:n});a.call(e,s),e.dispatchEvent(r)}},[l,s,n]),(0,r.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...i,tabIndex:-1,ref:c,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function S(e){return e?"checked":"unchecked"}var C=s(38503);function E(e){let{className:a,...s}=e;return(0,r.jsx)(v,{"data-slot":"switch",className:(0,C.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...s,children:(0,r.jsx)(N,{"data-slot":"switch-thumb",className:(0,C.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var K=s(82530),P=s(26650),A=s(93376),R=s(97937),T=s(18595),W=s(82533),J=s(35728),O=s(46383),Q=s(14232),Z=s(94986),_=s(3184),q=s(75367),F=s(90437),I=s(82999),D=s(31054);let V="force-dynamic",z=[{code:"zh-CN",nameKey:"chinese"},{code:"en-US",nameKey:"english"},{code:"ja-JP",nameKey:"japanese"},{code:"ko-KR",nameKey:"korean"},{code:"es-ES",nameKey:"spanish"},{code:"fr-FR",nameKey:"french"},{code:"ru-RU",nameKey:"russian"},{code:"it-IT",nameKey:"italian"},{code:"pt-PT",nameKey:"portuguese"},{code:"de-DE",nameKey:"german"},{code:"vi-VN",nameKey:"vietnamese"},{code:"uk-UA",nameKey:"ukrainian"},{code:"tr-TR",nameKey:"turkish"},{code:"id-ID",nameKey:"indonesian"},{code:"ar-SA",nameKey:"arabic"}];function B(){let{t:e}=(0,O.o)(),[a,s]=(0,t.useState)(""),[d,o]=(0,t.useState)("en-US"),[m,u]=(0,t.useState)(1),[h,p]=(0,t.useState)(!1),[x,y]=(0,t.useState)(!1),[b]=(0,t.useState)("aws"),[g]=(0,t.useState)(null),[j,f]=(0,t.useState)(!1),{data:v}=(0,F.useSession)(),[k,N]=(0,t.useState)(null),[w,S]=(0,t.useState)(!1),C=(0,I.s)();(0,t.useEffect)(()=>{y(!0);let e=()=>{};return e(),window.speechSynthesis.onvoiceschanged=e,()=>{window.speechSynthesis.onvoiceschanged=null}},[]);let V=async()=>{if(!w)try{S(!0);let s=!1;try{if(!(null==v?void 0:v.user))return;let r=await fetch("/api/user/plan");if(r.ok){let{permanentQuota:e,temporaryQuota:t,usedCharacters:n,quotaExpiry:i}=(await r.json()).characterQuota;if(e+(i&&new Date(i)>new Date?t:0)-n<a.length)return;s=!0}else console.error(e("quotaCheckFailed"))}catch(a){console.error(e("quotaCheckError"),a)}if(s)try{(await fetch("/api/user/update-quota",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usedCharacters:a.length})})).ok?console.log("字符配额更新成功，使用字符数: ".concat(a.length)):console.error(e("updateQuotaFailed"))}catch(a){console.error(e("updateQuotaError"),a)}}catch(a){console.error(e("speechSynthesisError"),a)}finally{S(!1)}},B=async()=>{try{if(!a||!k||!(null==v?void 0:v.user))return}catch(a){console.error(e("downloadError"),a)}},U=async e=>{var a;let r=null==(a=e.target.files)?void 0:a[0];if(r)try{if("text/plain"===r.type||r.name.endsWith(".txt")||r.name.endsWith(".md")){let e=new FileReader;e.onload=e=>{var a;let r=null==(a=e.target)?void 0:a.result;s(r)},e.readAsText(r)}else"application/pdf"===r.type||r.type.includes("word")||r.name.endsWith(".doc")||r.name.endsWith(".docx")||r.name.endsWith(".rtf")}catch(e){console.error("File upload error:",e)}},$=()=>{g&&(g.audioContext.suspend(),f(!1))},G=()=>{g&&(g.audioContext.resume(),f(!0))};return x?(0,r.jsxs)("div",{className:"min-h-screen",children:[(0,r.jsx)(Z.j,{}),(0,r.jsx)("main",{className:"container mx-auto px-4 py-4 md:py-8 space-y-4 md:space-y-8",children:(0,r.jsxs)(P.Zp,{className:"backdrop-blur-sm bg-background/80 border-primary/10 shadow-lg",children:[(0,r.jsx)(P.aR,{className:"border-b border-primary/10 pb-4 md:pb-6 flex justify-center items-center",children:(0,r.jsx)(P.ZB,{className:"text-2xl md:text-3xl font-bold bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 bg-clip-text text-transparent text-center",children:e("title")})}),(0,r.jsx)(P.Wu,{className:"pt-4 md:pt-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8",children:[(0,r.jsxs)(P.Zp,{className:"backdrop-blur-sm bg-background/80 border-primary/10 shadow-md",children:[(0,r.jsx)(P.aR,{className:"space-y-1 md:space-y-2",children:(0,r.jsx)(P.ZB,{className:"text-lg md:text-xl bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 bg-clip-text text-transparent",children:e("serviceSettings")})}),(0,r.jsx)(P.Wu,{className:"space-y-3 md:space-y-4",children:(0,r.jsxs)("div",{className:"space-y-3 md:space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-1.5 md:space-y-2",children:[(0,r.jsx)(K.J,{children:e("speechService")}),(0,r.jsxs)(c.l6,{value:"",children:[(0,r.jsx)(c.bq,{className:"h-9 md:h-10",children:(0,r.jsx)(c.yv,{})}),(0,r.jsxs)(c.gC,{children:[(0,r.jsx)(c.eb,{value:"aws",children:"AWS Polly"}),(0,r.jsx)(c.eb,{value:"minimax",children:"Minimax"}),(0,r.jsx)(c.eb,{value:"openai",children:"OpenAI TTS"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-1.5 md:space-y-2",children:[(0,r.jsx)(K.J,{children:e("selectLanguage")}),(0,r.jsxs)(c.l6,{value:d,onValueChange:e=>{o(e),C.trackEvent("change_language","settings",e)},children:[(0,r.jsx)(c.bq,{className:"h-9 md:h-10",children:(0,r.jsx)(c.yv,{})}),(0,r.jsx)(c.gC,{className:"max-h-[40vh] overflow-y-auto",children:z.map(a=>(0,r.jsx)(c.eb,{value:a.code,children:e(a.nameKey)},a.code))})]})]}),(0,r.jsxs)("div",{className:"space-y-1.5 md:space-y-2",children:[(0,r.jsx)(K.J,{children:e("voice")}),d&&(0,r.jsx)(D.E,{languageCode:d,onVoiceSelect:N,selectedVoiceId:null==k?void 0:k.id,provider:b})]}),(0,r.jsxs)("div",{className:"space-y-1.5 md:space-y-2",children:[(0,r.jsx)(K.J,{children:e("wordByWord")}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:h?e("on"):e("off")}),(0,r.jsx)(E,{checked:h,onCheckedChange:p})]})]}),(0,r.jsxs)("div",{className:"space-y-1.5 md:space-y-2",children:[(0,r.jsxs)(K.J,{children:[e("speed"),": ",m,"x"]}),(0,r.jsx)(l.A,{value:[m],onValueChange:e=>{let[a]=e;return u(a)},min:.5,max:2,step:.1,className:"py-1"})]})]})})]}),(0,r.jsxs)(P.Zp,{className:"backdrop-blur-sm bg-background/80 border-primary/10 shadow-md",children:[(0,r.jsx)(P.aR,{className:"space-y-1 md:space-y-2",children:(0,r.jsx)(P.ZB,{className:"text-lg md:text-xl bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 bg-clip-text text-transparent",children:e("readText")})}),(0,r.jsxs)(P.Wu,{className:"space-y-3 md:space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(i.T,{placeholder:e("inputPlaceholder"),className:"min-h-[120px] md:min-h-[200px] bg-background/70 backdrop-blur-sm border-primary/20 focus:border-primary/40 transition-all duration-300 resize-none text-sm md:text-base",value:a}),(0,r.jsxs)("div",{className:"absolute bottom-2 right-2 text-xs text-muted-foreground",children:[a.length," ",e("characters")]})]}),g&&(0,r.jsx)(_.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"w-full",children:(0,r.jsx)(Q.t,{audioContext:g.audioContext,audioSource:g.source,onPause:$,onResume:G,isPlaying:j})}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 md:gap-4",children:[(0,r.jsx)(q.Q,{children:(0,r.jsxs)(n.$,{onClick:V,className:"flex-1 h-9 md:h-10 text-sm bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 hover:from-blue-600 hover:via-purple-600 hover:to-pink-600 transition-all duration-300",children:[(0,r.jsx)(A.A,{className:"mr-2 h-4 w-4"}),e("readText")]})}),g&&(0,r.jsx)(_.P.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},children:(0,r.jsx)(q.Q,{children:(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:j?$:G,className:"h-9 md:h-10 w-9 md:w-10 border-primary/20 hover:border-primary/40",children:j?(0,r.jsx)(R.A,{className:"h-4 w-4"}):(0,r.jsx)(T.A,{className:"h-4 w-4"})})})}),(0,r.jsx)(q.Q,{children:(0,r.jsxs)(n.$,{variant:"outline",onClick:B,className:"flex-1 h-9 md:h-10 text-sm border-primary/20 hover:border-primary/40 hover:bg-primary/5",children:[(0,r.jsx)(W.A,{className:"mr-2 h-4 w-4"}),e("downloadAudio")]})}),(0,r.jsx)(q.Q,{children:(0,r.jsx)(n.$,{variant:"outline",className:"flex-1 h-9 md:h-10 text-sm border-primary/20 hover:border-primary/40 hover:bg-primary/5",asChild:!0,children:(0,r.jsxs)("label",{children:[(0,r.jsx)(J.A,{className:"mr-2 h-4 w-4"}),e("uploadFile"),(0,r.jsx)("input",{type:"file",className:"hidden",accept:".txt,.md",onChange:U})]})})})]})]})]})]})})]})})]}):null}},87584:(e,a,s)=>{Promise.resolve().then(s.bind(s,36337))}},e=>{var a=a=>e(e.s=a);e.O(0,[181,889,617,184,543,383,197,548,773,261,358],()=>a(87584)),_N_E=e.O()}]);